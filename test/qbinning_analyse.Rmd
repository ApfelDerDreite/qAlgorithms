---
title: "Analysis qbinning"
author: "Daniel HÃ¶hn"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir = "G:/_Studium/Analytik-Praktikum/qbinning")
library(tidyverse)
library(data.table)
library(patchwork)
```


```{r}
bin_termination <- read.csv("opstats_subsetmz.csv")
bin_termination$change <- 1
bin_termination$change[40550:86922] <- 2
bin_termination$change[86923:93780] <- 3
bin_termination$change[93781:94537] <- 4
bin_termination$change[94538:94619] <- 5
bin_termination$change[94620:94626] <- 6

```


```{r}
ggplot(bin_termination[which(bin_termination$change == 1),])+
  geom_histogram(aes(binend - binstart),binwidth = 1)+
  scale_y_continuous(trans='log10')+
  xlab("Binsize after mz subsetting (no separation by scans)")+
  ylab("Counts")+
  theme_bw()

ggplot(bin_termination[which(bin_termination$change == 1),])+
  geom_histogram(aes(subsets),binwidth = 1)+
  scale_y_continuous(trans='log10')+
  xlab("Subsets performed until next bin was found (no separation by scans)")+
  ylab("Counts")+
  theme_bw()

ggplot(bin_termination[which(bin_termination$change == 2),])+
  geom_histogram(aes(binend - binstart),binwidth = 1)+
  scale_y_continuous(trans='log10')+
  xlab("Binsize after mz subsetting (no separation by scans)")+
  ylab("Counts")+
  theme_bw()

ggplot(bin_termination[which(bin_termination$change == 2),])+
  geom_histogram(aes(subsets),binwidth = 1)+
  scale_y_continuous(trans='log10')+
  xlab("Subsets performed until next bin was found (no separation by scans)")+
  ylab("Counts")+
  theme_bw()

ggplot(bin_termination[which(bin_termination$change == 3),])+
  geom_histogram(aes(binend - binstart),binwidth = 1)+
  scale_y_continuous(trans='log10')+
  xlab("Binsize after mz subsetting (no separation by scans)")+
  ylab("Counts")+
  theme_bw()

ggplot(bin_termination[which(bin_termination$change == 3),])+
  geom_histogram(aes(subsets),binwidth = 1)+
  scale_y_continuous(trans='log10')+
  xlab("Subsets performed until next bin was found (no separation by scans)")+
  ylab("Counts")+
  theme_bw()

ggplot(bin_termination[which(bin_termination$change == 4),])+
  geom_histogram(aes(binend - binstart),binwidth = 1)+
  scale_y_continuous(trans='log10')+
  xlab("Binsize after mz subsetting (no separation by scans)")+
  ylab("Counts")+
  theme_bw()

ggplot(bin_termination[which(bin_termination$change == 4),])+
  geom_histogram(aes(subsets),binwidth = 1)+
  scale_y_continuous(trans='log10')+
  xlab("Subsets performed until next bin was found (no separation by scans)")+
  ylab("Counts")+
  theme_bw()

ggplot(bin_termination[which(bin_termination$change == 5),])+
  geom_histogram(aes(binend - binstart),binwidth = 1)+
  xlab("Binsize after mz subsetting (no separation by scans)")+
  ylab("Counts")+
  theme_bw()

ggplot(bin_termination[which(bin_termination$change == 5),])+
  geom_histogram(aes(subsets),binwidth = 1)+
  xlab("Subsets performed until next bin was found (no separation by scans)")+
  ylab("Counts")+
  theme_bw()

ggplot(bin_termination[which(bin_termination$change == 6),])+
  geom_histogram(aes(binend - binstart),binwidth = 1)+
  xlab("Binsize after mz subsetting (no separation by scans)")+
  ylab("Counts")+
  theme_bw()

ggplot(bin_termination[which(bin_termination$change == 6),])+
  geom_histogram(aes(subsets),binwidth = 1)+
  xlab("Subsets performed until next bin was found (no separation by scans)")+
  ylab("Counts")+
  theme_bw()
```


```{r}
runstats <- data.frame(before_mz = c(1,57649,8716,1040,117,14,0), after_mz = c(40549,46373,6858,757,82,7,0), newbins = c(4114, 33589, 5134, 551, 54, 6, 0), perfectbins = c(2716,14905,1469,143,7,0,0))
```

