---
title: "Analysis qbinning"
author: "Daniel HÃ¶hn"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# knitr::opts_knit$set(root.dir = "G:/_Studium/Analytik-Praktikum/qbinning")
library(tidyverse)
library(data.table)
library(patchwork)
```

```{r bin results}
qbins <- read.csv("../../qBinning_binsummary.csv")
qcontrol <- read.csv("../../rawdata/df_qBinning_test.csv")
qcontrol <- qcontrol[which(qcontrol$ID != -1),]

# plot(qbins$mean_mz, qbins$mean_scans)

hist(qbins$mean_mz)
hist(qbins$mean_scans)
hist(qbins$mean_DQS)
hist(qbins$size)

```

```{r steps per bin}
getwd()
qbins <- read.csv("../../qBinning_binposition.csv")
qbins$index <- c(1:length(qbins$mzmin))

ggplot(qbins)+
  geom_rect(aes(xmin = scanmin, xmax = scanmax, ymin = mzmin, ymax = mzmax, colour = index))
```


```{r}
binstats <- read.csv("binstats.csv")
hist(log(binstats$time.DQSB.))
plot(binstats$size, binstats$time.DQSB.)
plot(binstats$mean.scans., -binstats$scanRange/binstats$size)
plot(binstats$mean.mz., log(-binstats$scanRange/binstats$size))
plot(log(binstats$time.DQSB.), binstats$mean.DQS.)
```


```{r}
bins <- read.csv("C:/Users/unisys/Documents/Studium/Analytik-Praktikum/qBinning_binlist.csv")
allfeats <- bins[1:3568034,]
bins <- bins[3568035:5932735,] # 66% der feature sind in bins
for (i in c(1:3568034)) {
  if (allfeats$mz[i] %in% bins$mz){
  allfeats <- allfeats[-i,]}
}


```

